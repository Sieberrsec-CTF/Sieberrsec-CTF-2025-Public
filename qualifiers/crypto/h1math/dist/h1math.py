from Crypto.Util.number import bytes_to_long, getPrime
from secrets import randbits

FLAG = b'sctf{????????????}'

p = getPrime(1024)
q = getPrime(1024)

def encrypt(msg):
    m = bytes_to_long(msg)
    a = randbits(10)
    return (a*p**2 + m*p*q + q**2)

n = len(FLAG)

print(f'n = {n}')
print(f'c1 = {encrypt(FLAG[:n//3])}')
print(f'c2 = {encrypt(FLAG[n//3:2*n//3])}')
print(f'c3 = {encrypt(FLAG[2*n//3:])}')

'''
n = 28
c1 = 58097224196230264215278493888334231793974214872635770308159745868205088438305730969164879668323823398025816216681039282923704936231622484945567950111899590026291066144645889426395149188442667315028705611652976766185175684251481174340437662683044999915311830896651282798881558689576260825173065975742678633660852343223364741323847107683795044324180089181156854167830281111751903270475971703358109201934159514058689631003407535359894692984260727800984323291973959138488683301937199239850283189827750829187948950046234276405720781996903689034945235570172345930264987577274109489129932324362900052968725120804410884829447992534432132438052676
c2 = 53060272457917969694479061060932049509037090877492036062646762512500422299497765499024529983718888212731138479103654888129699512725241434401947003208066156136845674912218721712534141528563212728650861032824014322050988546922108094362471538140520836705439986066349717218940117600629812988562730241520746086454156850196333371876390604632462057215991665288746138008857643835425158855668745709810550942430816122148062735119012070508267949649628085436661628891605748517571470754851144253076988746251423269800246734238308346535259149380278117189073888607191681424902881472234971948577258188046429396773929324112046890008193232616354340863947974
c3 = 15132693003068557432502508868792509652900570740880522419117468389639497939619665737003229021172868774104772601321183593719079810875672410975059233968284437548363304711993132134629502074259477941558825924160240458172075681153032104632734016486570018861128848913823174611290805409570351157725094974981116926759138063001435558977513010735311823869257937749306605330489252484220256501037735104286849313514846683825132063007733773679796161467863519031342194872695245054932018665228442953904930762284950754751746685489015626928524962398507720086657520032634941067656838787028649484824185690038573623070708004756497530244479718569897717251766089519
''' 